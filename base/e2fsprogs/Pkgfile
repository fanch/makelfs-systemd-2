# Description: Utilities for handling the ext2,3 and 4 files system.
# URL: http://e2fsprogs.sourceforge.net/
# Maintainers: Ted Ts'o tytso at mit dot edu,tytso at alum dot mit dot edu
# Packagers: fanch at nutyx dot org

name=e2fsprogs
version=1.43.4
release=1

source=(http://prdownloads.sourceforge.net/$name/$name-$version.tar.gz)


build()
{
cd $name-$version

mkdir -v build
cd build
LIBS=-L/tools/lib \
CFLAGS=-I/tools/include \
PKG_CONFIG_PATH=/tools/lib/pkgconfig \
../configure --prefix=/usr --with-root-prefix="" --libdir=/lib \
--bindir=/bin --sbindir=/sbin \
--enable-elf-shlibs --disable-libblkid --disable-libuuid --disable-uuidd \
--disable-fsck
make || make -j1
# somes tests may fails
# make check||true
make DESTDIR=$PKG install install-libs || make -j1 DESTDIR=$PKG install install-libs

chmod -v u+w $PKG/lib/{libcom_err,libe2p,libext2fs,libss}.a

gunzip -v $PKG/usr/share/info/libext2fs.info.gz

makeinfo -o doc/com_err.info ../lib/et/com_err.texinfo

install -v -m644 doc/com_err.info $PKG/usr/share/info

rm -rf $PKG/usr/share/info/dir

mkdir $PKG/usr/lib
mv $PKG/lib/pkgconfig \
$PKG/usr/lib
}

